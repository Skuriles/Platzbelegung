<div class="mat-typography">
  <div class="example-button-row">
    <button
      mat-raised-button
      (click)="login()"
      *ngIf="!loginService.loggedIn"
      color="primary"
    >
      Bearbeiten
    </button>
    <button mat-raised-button (click)="toggleDate()" color="basic">
      <span *ngIf="!showOldDates">Alle Events</span>
      <span *ngIf="showOldDates">Neue Events</span>
    </button>
    <button
      mat-raised-button
      (click)="isMobileScreen = !isMobileScreen; setGui(isMobileScreen)"
      color="basic"
    >
      <span *ngIf="!isMobileScreen">Mobile Ansicht</span>
      <span *ngIf="isMobileScreen">Desktopmodus</span>
    </button>
    <button
      mat-stroked-button
      (click)="logout()"
      *ngIf="loginService.loggedIn"
      color="primary"
    >
      Ausloggen
    </button>

    <button
      mat-mini-fab
      color="primary"
      (click)="newGame()"
      *ngIf="loginService.loggedIn && adminBtn"
      class="addbtn"
    >
      <mat-icon>add</mat-icon>
    </button>
  </div>
  <div class="calendar-box">
    <h2>{{ viewDate | calendarDate: view + "ViewTitle":"de-DE" }}</h2>
    <div class="example-button-row">
      <button
        mat-raised-button
        mwlCalendarPreviousView
        [view]="view"
        [(viewDate)]="viewDate"
        (viewDateChange)="closeOpenMonthViewDay()"
      >
        Zurück
      </button>
      <button mat-raised-button mwlCalendarToday [(viewDate)]="viewDate">
        Heute
      </button>
      <button
        mat-raised-button
        mwlCalendarNextView
        [view]="view"
        [(viewDate)]="viewDate"
        (viewDateChange)="closeOpenMonthViewDay()"
      >
        Nächster
      </button>
    </div>
    <mwl-calendar-month-view
      [viewDate]="viewDate"
      [events]="allEvents"
      [activeDayIsOpen]="activeDayIsOpen"
      [refresh]="refresh"
      (dayClicked)="dayClicked($event.day)"
      (eventClicked)="handleEvent('Clicked', $event.event)"
      (eventTimesChanged)="eventTimesChanged($event)"
    >
    </mwl-calendar-month-view>
  </div>
  <div class="filter">
    <mat-form-field>
      <mat-label>Filter</mat-label>
      <input
        matInput
        (keyup)="applyFilter($event)"
        placeholder="Suche - Datum mit 2020-10-24 Format"
        #input
      />
    </mat-form-field>
  </div>
  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
    <ng-container matColumnDef="datum">
      <th mat-header-cell *matHeaderCellDef>Datum</th>
      <td
        mat-cell
        *matCellDef="let element"
        [ngClass]="{ mobileDate: isMobileScreen }"
      >
        <span *ngIf="!element.weekEndRow && !isMobileScreen && !element.allDay">
          {{
            element.startDatetime
              | dateTimeToFormat: "ccc, d. MMMM yyyy - HH:mm"
          }}
          Uhr
        </span>
        <span *ngIf="!element.weekEndRow && isMobileScreen && !element.allDay">
          {{ element.startDatetime | dateTimeToFormat: "dd.MM - HH:mm" }}
        </span>
        <span *ngIf="!element.weekEndRow && element.allDay">
          {{ element.startDatetime | dateTimeToFormat: "dd.MM" }} - Ganztag
        </span>
        <span *ngIf="element.weekEndRow">
          {{ element.weekEndText }}
        </span>
      </td>
    </ng-container>
    <ng-container matColumnDef="datumEnd">
      <th mat-header-cell *matHeaderCellDef>Ende</th>
      <td
        mat-cell
        *matCellDef="let element"
        [ngClass]="{ mobileDate: isMobileScreen }"
      >
        <span *ngIf="!element.weekEndRow && !isMobileScreen && !element.allDay">
          {{
            element.endDatetime | dateTimeToFormat: "ccc, d. MMMM yyyy - HH:mm"
          }}
          Uhr
        </span>
        <span *ngIf="!element.weekEndRow && isMobileScreen && !element.allDay">
          {{ element.endDatetime | dateTimeToFormat: "dd.MM - HH:mm" }}
        </span>
        <span *ngIf="!element.weekEndRow && element.allDay">
          {{ element.endDatetime | dateTimeToFormat: "dd.MM" }} - Ganztag
        </span>
      </td>
    </ng-container>

    <ng-container matColumnDef="mannschaft">
      <th mat-header-cell *matHeaderCellDef>Mannschaft</th>
      <td mat-cell *matCellDef="let element">
        <div class="infoText" *ngIf="!element.weekEndRow && !isMobileScreen">
          {{ element.mannschaft }}
        </div>
        <div class="infoText" *ngIf="!element.weekEndRow && isMobileScreen">
          {{ element.mannschaftShort }}
        </div>
        <div *ngIf="!element.weekEndRow && isMobileScreen">
          <mat-icon
            aria-hidden="false"
            aria-label="info Icon"
            class="infoIcon"
            (click)="showInfo(element)"
            >info</mat-icon
          >
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="details">
      <th mat-header-cell *matHeaderCellDef>Details</th>
      <td mat-cell *matCellDef="let element">{{ element.details }}</td>
    </ng-container>

    <ng-container matColumnDef="person">
      <th mat-header-cell *matHeaderCellDef>Person</th>
      <td mat-cell *matCellDef="let element">{{ element.person }}</td>
    </ng-container>

    <ng-container matColumnDef="edit">
      <th mat-header-cell *matHeaderCellDef>
        <mat-icon aria-hidden="false" aria-label="Edit Icon">edit</mat-icon>
      </th>
      <td mat-cell *matCellDef="let element" class="editCol">
        <mat-icon
          aria-hidden="false"
          aria-label="Edit Icon"
          (click)="edit(element)"
          *ngIf="!element.weekEndRow"
          >edit</mat-icon
        >
      </td>
    </ng-container>

    <ng-container matColumnDef="delete">
      <th mat-header-cell *matHeaderCellDef>
        <mat-icon aria-hidden="false" aria-label="delete Icon">delete</mat-icon>
      </th>
      <td mat-cell *matCellDef="let element" class="editCol">
        <mat-icon
          aria-hidden="false"
          aria-label="delete Icon"
          (click)="delete(element)"
          *ngIf="!element.weekEndRow"
          >delete</mat-icon
        >
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr
      mat-row
      *matRowDef="let row; columns: displayedColumns"
      [ngClass]="{ weekRow: row.weekEndRow }"
    ></tr>
  </table>
</div>
